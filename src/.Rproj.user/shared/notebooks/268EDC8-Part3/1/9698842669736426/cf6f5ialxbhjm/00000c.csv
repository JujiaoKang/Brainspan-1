"0","use_driver <- ""GNAI2_SIG"""
"0","# Define edges of the network"
"0","edge_score <- analysis.par$merge.network$target_list[[use_driver]]$MI*sign(analysis.par$merge.network$target_list[[use_driver]]$spearman)"
"0","names(edge_score) <- analysis.par$merge.network$target_list[[use_driver]]$target"
"0","# Draw sub-network structure of selected driver"
"0","ms_tab <- gse_list[[""GSE28521""]]$final_ms_tab"
"0","comp_name <- 'ASD.Vs.TD'"
"0","draw.targetNet(source_label=ms_tab[use_driver,'gene_label'],source_z=ms_tab[use_driver,sprintf('Z.%s_DA',comp_name)],edge_score = edge_score,pdf_file='/cluster/home/chenhy/project/Brainspan/result/plot/targetNet_out.pdf',label_cex = 1.5,n_layer=4, alphabetical_order=TRUE)"
"1","[1]"
"1"," TRUE"
"1","
"
"0","draw.targetNet(source_label=ms_tab[use_driver,'gene_label'],source_z=ms_tab[use_driver,sprintf('Z.%s_DA',comp_name)],edge_score = edge_score,pdf_file=sprintf('%s/targetNet_in.pdf','/cluster/home/chenhy/project/Brainspan/result/plot'),label_cex = 1.5,arrow_direction = 'in',n_layer=6)"
"1","[1]"
"1"," TRUE"
"1","
"
"0","# Draw sub-network structure for two selected drivers"
"0","# Use the first two drivers in the driver list as an example"
"0","use_driver2 <- ""TBP_SIG"""
"0","edge_score2 <- analysis.par$merge.network$target_list[[use_driver2]]$MI*sign(analysis.par$merge.network$target_list[[use_driver2]]$spearman)"
"0","names(edge_score2) <- analysis.par$merge.network$target_list[[use_driver2]]$target"
"0","use_genes <- unique(analysis.par$merge.network$network_dat$target.symbol)"
"0","draw.targetNet.TWO(source1_label=ms_tab[use_driver,'gene_label'],edge_score1 = edge_score,"
"0","                   source2_label=ms_tab[use_driver2,'gene_label'],edge_score2 = edge_score2,"
"0","                   source1_z=ms_tab[use_driver,sprintf('Z.%s_DA',comp_name)],source2_z=ms_tab[use_driver2,sprintf('Z.%s_DA',comp_name)],pdf_file=sprintf('%s/targetNetTWO.pdf','/cluster/home/chenhy/project/Brainspan/result/plot'),total_possible_target=use_genes,show_test=TRUE,label_cex = 1.5,n_layer=1,source_cex=0.6,alphabetical_order=FALSE)"
"1","[1]"
"1"," ""GNAI2_SIG has 50 unique targets !"""
"1","
"
"1","[1]"
"1"," ""TBP_SIG has 15 unique targets !"""
"1","
"
"1","                       "
"1"," In TBP_SIG target"
"1"," Not in TBP_SIG target"
"1","
In GNAI2_SIG target    "
"1","                 1"
"1","                    49"
"1","
Not in GNAI2_SIG target"
"1","                14"
"1","                  9520"
"1","
"
"1","           P.Value "
"1","        Odds_Ratio "
"1","Intersected_Number "
"1","
"
"1","        0.07551438 "
"1","       13.87755102 "
"1","        1.00000000 "
"1","
"
"0","# To show the overlapped target genes from two selected drivers"
"0","test.targetNet.overlap(source1_label=ms_tab[use_driver,'gene_label'],source2_label=ms_tab[use_driver2,'gene_label'],target1 = names(edge_score),target2 = names(edge_score2),total_possible_target=use_genes)"
"1","[1]"
"1"," ""GNAI2_SIG has 50 unique targets !"""
"1","
"
"1","[1]"
"1"," ""TBP_SIG has 15 unique targets !"""
"1","
"
"1","                       "
"1"," In TBP_SIG target"
"1"," Not in TBP_SIG target"
"1","
In GNAI2_SIG target    "
"1","                 1"
"1","                    49"
"1","
Not in GNAI2_SIG target"
"1","                14"
"1","                  9520"
"1","
"
"1","           P.Value "
"1","        Odds_Ratio "
"1","Intersected_Number "
"1","
"
"1","        0.07551438 "
"1","       13.87755102 "
"1","        1.00000000 "
"1","
"
